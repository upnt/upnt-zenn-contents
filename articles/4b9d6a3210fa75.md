---
title: "conanã‚’ä½¿ã£ã¦Makefileã®ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ãƒ‘ã‚¹(-I)ã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ‘ã‚¹(-L)ã‚’è§£æ±ºã™ã‚‹"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["cpp", "conan", "Makefile"]
published: true
---

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã§ã¯Conan + Makefileã‚’ä½¿ã£ãŸC++ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ–¹æ³•ã‚’ã„ã‚ã„ã‚ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«åˆã‚ã›ã¦ç´¹ä»‹ã—ã¾ã™ã€‚
`Makefile`ã‚’å«ã‚ãŸ[ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé›†](#ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé›†)ã‚‚è¼‰ã›ã¦ã„ã‚‹ã®ã§ã€ã‚ã¾ã‚Šmakeã‚‚è¼‰ã›ã¦ã„ã‚‹ã®ã§ã€ã‚ã¾ã‚Šmakeã«ãªã‚Œã¦ã„ãªã„æ–¹ã§ã‚‚ç°¡å˜ã«å°å…¥ã§ãã¾ã™ã€‚

å‚è€ƒã¾ã§ã«makeã«é–¢ã™ã‚‹è¨˜äº‹ã‚’ã„ãã¤ã‹æŒ™ã’ã¦ãŠãã¾ã™ã€‚
@[card](https://qiita.com/mizcii/items/cfbd2aa17f6b7517c37f)
@[card](https://zenn.dev/keitean/articles/aaef913b433677)
@[card](https://www.gnu.org/software/make/manual/make.html)

# Conanã£ã¦ä½•ï¼Ÿ

Conanã¯C++ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç®¡ç†ã§ãã‚‹éå¸¸ã«å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚C++ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«ã¨ã„ãˆã°ä»–ã«ã‚‚vcpkgãŒã‚ã‚Šã¾ã™ãŒã€Conanã¯Makefileã‚’å«ã‚€å¤šãã®ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã«ã‚‚å®Œå…¨å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
@[card](https://conan.io)

ã“ã®è¨˜äº‹ã®å†…å®¹ã¯ä¸»ã«ä»¥ä¸‹ã®å…¬å¼ã‚µã‚¤ãƒˆã®ãƒšãƒ¼ã‚¸ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚
@[card](https://docs.conan.io/2/integrations/makefile.html)
@[card](https://docs.conan.io/2/reference/tools/gnu/makedeps.html#conan-tools-gnu-makedeps)

# Conan + Makefileã®åŸºæœ¬çš„ãªä½¿ã„æ–¹

## 0. ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯Conan + Makefileã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ãŸã‚ã®æ‰‹é †ã‚’ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§ç´¹ä»‹ã—ã¾ã™ã€‚
æ¬¡ã®ã‚ˆã†ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«Conanã‚’å°å…¥ã™ã‚‹çŠ¶æ³ã‚’æƒ³å®šã—ã¾ã™ã€‚

```bash
- Makefile
- main.cpp
```

`Makefile`:

```Makefile
CXX ?= g++

%: %.cpp
	$(CXX) $< -o $@
```

`main.cpp`:

```cpp
#include <boost/program_options.hpp>
#include <iostream>

int main(int argc, char* argv[]) {
    namespace po = boost::program_options;

    po::options_description desc("Options");
    desc.add_options()
        ("help,h", "Show help message")
        ("value,v", po::value<int>(), "Example value");

    po::variables_map vm;
    po::store(po::parse_command_line(argc, argv, desc), vm);
    po::notify(vm);

    if (vm.count("help")) {
        std::cout << desc << "\n";
        return 0;
    }

    if (vm.count("value")) {
        std::cout << "Value = " << vm["value"].as<int>() << "\n";
    }

    return 0;
}
```

`main.cpp`ã¯boostãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ä¾å­˜ã—ã¦ãŠã‚Šã€ã“ã“ã¾ã¾ã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã¾ã›ã‚“ã€‚Conanã‚’ä½¿ã£ã¦boostãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ ã—ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

## 1. conanfile.txtã‚’æ›¸ã“ã†

ã¾ãšã¯ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¨˜è¿°ã™ã‚‹ãŸã‚ã®ãƒ•ã‚¡ã‚¤ãƒ«ã€`conanfile.txt`ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼
Conan + Makefileã‚’ä½¿ã†å ´åˆã€`conanfile.txt`ã‚’`Makefile`ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç½®ãã¾ã™ã€‚

```bash
- conanfile.txt
- Makefile
- main.cpp
```

`conanfile.txt`ã§ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨˜è¿°ã§ãã¾ã™ã€‚

```ini
[requires]
boost/1.87.0

[generators]
MakeDeps
```

- requires: ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›¸ãã¨ã“ã‚
- generators: ç”Ÿæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ã‚’æ›¸ãã¨ã“ã‚

ä»Šå›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯boost + Makefileã‚’ä½¿ã†ã®ã§\[requires\]ã«ã¯`boost/1.87.0`ã‚’ã€\[generators\]ã«ã¯`MakeDeps`ã‚’è¿½åŠ ã—ã¾ã™ã€‚

## 2. ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚ã†

ç¶šã„ã¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ãŒè¨˜è¿°ã•ã‚ŒãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã“ã¨ã§è‡ªå‹•ç”Ÿæˆã§ãã¾ã™ã€‚

```bash
conan profile detect
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸå¾Œã€`~/.conan2/profiles`ã®ã¨ã“ã‚ã«`default`ã¨ã„ã†è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚

`default`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ä¾‹:

```ini
[settings]
arch=x86_64
build_type=Release
compiler=gcc
compiler.cppstd=gnu17
compiler.libcxx=libstdc++11
compiler.version=13
os=Linux
```

ä¸€éƒ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ç’°å¢ƒã§ã¯`default`ã¨ã¯é•ã£ãŸãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªåˆ†ã§å®šç¾©ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚
ã“ã®è¨˜äº‹ã§ã¯ã„ãã¤ã‹ã®ä¾‹ã‚’ç´¹ä»‹ã™ã‚‹ç¨‹åº¦ã«ã¨ã©ã‚ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚
@[card](https://qiita.com/kannkyo/items/fdcf2d015dc160582353)
@[card](https://www.docswell.com/s/4783183/KN1JJ2-2024-10-23-203710#p10)

## 3. ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†

ã“ã“ã¾ã§ãã‚Œã°ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ç°¡å˜ã§ã™ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```bash
conan install . --build=missing --output-folder=conan
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ„å‘³ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

- build: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«ã©ã†ã‚„ã£ã¦ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã‹ã‚’æŒ‡å®šã€‚"missing"ã«ã™ã‚‹ã¨ã‚½ãƒ¼ã‚¹ã‹ã‚‰è‡ªå‹•ã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã€‚
- output-folder: ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆå…ˆã‚’æŒ‡å®šã€‚ä»Šå›ã¯`conan/`ã¨ã„ã†åå‰ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç”Ÿæˆã—ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šä¾å­˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒ`~/.conan2/`ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€åŒæ™‚ã«æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

```bash
conan/conandeps.mk
```

ã“ã®`.mk`ã‚’`Makefile`ã§èª­ã¿è¾¼ã‚€ã ã‘ã§ã€ç°¡å˜ã«includeãƒ‘ã‚¹ã‚„libãƒ‘ã‚¹ã‚’è‡ªå‹•ã§è§£æ±ºã—ã¦ãã‚Œã¾ã™ã€‚

:::message
ã“ã“ã§ã¯`conandeps.mk`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸãŒã€ã“ã‚Œã¯generatorã«MakeDepsã‚’è¨­å®šã—ãŸãŸã‚ã§ã™ã€‚ä¾‹ãˆã°AutotoolsDepsã‚’æŒ‡å®šã™ã‚‹ã¨LDFLAGSã¨ã‹ã‚’exportã™ã‚‹ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ`conanautotoolsdeps.sh`ã‚’ä½œã£ã¦ãã‚Œã¾ã™ã€‚
ã•ã‚‰ã«ã¯ã“ã®generatorã¯è¤‡æ•°æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã€ãŸã¨ãˆã° MakeDeps ã¨ AutotoolsDeps ã‚’åŒæ™‚ã«ç”Ÿæˆã—ã€å¿…è¦ã«å¿œã˜ã¦ conanautotoolsdeps.sh ã‚’ source ã—ã¦ä½¿ã†ã€ã¨ã„ã†é‹ç”¨ã‚‚ã§ãã¾ã™ã€‚
generatorã‚’è‰²ã€…è©¦ã—ã¦ã¿ã‚‹ã®ã‚‚é¢ç™½ã„ã¨æ€ã„ã¾ã™ã€‚
:::

## 4. Makefileã‹ã‚‰conandeps.mkã‚’èª­ã¿è¾¼ã‚€

`Makefile`ã§`conandeps.mk`ã‚’èª­ã¿è¾¼ã‚€ã«ã¯`Makefile`ã®å…ˆé ­ã«æ¬¡ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```Makefile
include conandeps.mk
```

ã“ã‚Œã«ã‚ˆã‚Šä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ãŒ`Makefile`ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚

| å¤‰æ•°                 | å†…å®¹                                      |
| -------------------- | ----------------------------------------- |
| `CONAN_INCLUDE_DIRS` | `/path/to/include` ã®ãƒªã‚¹ãƒˆ               |
| `CONAN_LIB_DIRS`     | `/path/to/lib` ã®ãƒªã‚¹ãƒˆ                   |
| `CONAN_LIBS`         | `boost_program_options`ãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå |

ä¾‹ãˆã°ã€å®Ÿéš›ã®`CONAN_INCLUDE_DIRS`ã¯ã“ã‚“ãªæ„Ÿã˜ã«ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã§ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ãƒ‘ã‚¹ãŒä¸¦ã‚“ã§ã„ã¾ã™ã€‚

```
/home/upnt/.conan2/p/b/onetb9cd273fcb17be/p/include /home/upnt/.conan2/p/b/hwlocdb3bfb5eea16e/p/include /home/upnt/.conan2/p/b/boost1ecd82564e417/p/include /home/upnt/.conan2/p/b/zlib11cf905ad2bb7/p/include /home/upnt/.conan2/p/b/bzip214aa86f64b388/p/include /home/upnt/.conan2/p/b/libba4a2544804436a/p/include
```

ã“ã‚Œã‚’ä½¿ã£ã¦ã€æœ€å°æ§‹æˆã®`Makefile`ã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã¾ã™ã€‚

```Makefile
include conan/conandeps.mk

CXX ?= g++
CXXFLAGS += $(addprefix -I,$(CONAN_INCLUDE_DIRS))
LDFLAGS += $(addprefix -L,$(CONAN_LIB_DIRS))
LDLIBS += $(addprefix -l,$(CONAN_LIBS))

%: %.cpp
	$(CXX) $(CXXFLAGS) $< -o $@ $(LDFLAGS) $(LDLIBS)
```

ã“ã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ç°¡å˜ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å°å…¥ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Œã¡ã‚ƒã„ã¾ã™ï¼ã“ã“ã‹ã‚‰ã¯ã„ãã¤ã‹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ã‚‚ã¨ã«å…·ä½“çš„ãªä½¿ã„æ–¹ã‚’ç´¹ä»‹ã—ã¾ã—ã‚‡ã†ã€‚

## 5. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã¿ã‚ˆã†ï¼

å¾Œã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ã™ã‚‹ã ã‘ã§ã™ï¼ä¸€åº¦ã“ã‚Œã¾ã§ã®å†…å®¹ã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã™ã€‚

ç¾åœ¨ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ã“ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚

```
- conanfile.txt
- Makefile
- main.cpp
```

ãã—ã¦ã€å„ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã¯ä»¥ä¸‹ã®é€šã‚Šã«ãªã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã€‚

`conanfile.txt`:

```ini
[requires]
boost/1.87.0

[generators]
MakeDeps
```

`Makefile`:

```Makefile
include conan/conandeps.mk

CXX ?= g++
CXXFLAGS += $(addprefix -I,$(CONAN_INCLUDE_DIRS))
LDFLAGS += $(addprefix -L,$(CONAN_LIB_DIRS))
LDLIBS += $(addprefix -l,$(CONAN_LIBS))

%: %.cpp
	$(CXX) $(CXXFLAGS) $< -o $@ $(LDFLAGS) $(LDLIBS)
```

`main.cpp`:

```cpp
#include <boost/program_options.hpp>
#include <iostream>

int main(int argc, char* argv[]) {
    namespace po = boost::program_options;

    po::options_description desc("Options");
    desc.add_options()
        ("help,h", "Show help message")
        ("value,v", po::value<int>(), "Example value");

    po::variables_map vm;
    po::store(po::parse_command_line(argc, argv, desc), vm);
    po::notify(vm);

    if (vm.count("help")) {
        std::cout << desc << "\n";
        return 0;
    }

    if (vm.count("value")) {
        std::cout << "Value = " << vm["value"].as<int>() << "\n";
    }

    return 0;
}
```

å¾Œã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã§ã€conanãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸboost ã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ãã‚Œã¾ã™ï¼

```bash
make main
```

ç”Ÿæˆã•ã‚ŒãŸå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼

```bash
./main --value 42
```

ã†ã¾ãã„ãã¨`Value = 42`ã¨ã„ã†å‡ºåŠ›ãŒã•ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚ã“ã‚Œã§conanã®å°å…¥ã¯å®Œäº†ã§ã™ï¼

# ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé›†

ã“ã“ã‹ã‚‰ã¯ã„ãã¤ã‹ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç´¹ä»‹ã—ã¦ã„ãã¾ã™ã€‚ä»Šå¾Œã‚‚è¿½åŠ äºˆå®šã§ã™ã®ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã‚Œã°æ°—è»½ã«ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ãã ã•ã„ã€‚

## 1. è¤‡æ•°ã®mainãŒã‚ã‚‹å ´åˆ

å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°ä½œã‚ŠãŸã„å ´åˆã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ§‹æˆã§ã™ã€‚ç‰¹ã«ä»Šå›ã¯`main1.cpp`ãŒboost_program_optionsã‚’ä½¿ç”¨ã—ã€`main2.cpp`ãŒonetbbã‚’ä½¿ç”¨ã™ã‚‹ã¨ã„ã†ã‚±ãƒ¼ã‚¹ã‚’è€ƒãˆã¾ã™ã€‚

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ:

```
- conanfile.txt
- Makefile
- src/
  - main1.cpp
  - main2.cpp
- build/
  - ã“ã“ã«å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã
```

`conanfile.txt`:

```ini
[requires]
boost/1.87.0
onetbb/2021.13.0

[generators]
MakeDeps
```

`Makefile`:

```Makefile
include conan/conandeps.mk

CXX ?= g++
CXXFLAGS += $(addprefix -I,$(CONAN_INCLUDE_DIRS))
LDFLAGS += $(addprefix -L,$(CONAN_LIB_DIRS))

SRCDIR := src
BINDIR := build
TARGETS := $(BINDIR)/main1 $(BINDIR)/main2

.PHONY: all clean
all: $(BINDIR) $(TARGETS)

$(BINDIR):
	mkdir -p $(BINDIR)

$(BINDIR)/main1: $(SRCDIR)/main1.cpp
	$(CXX) $(CXXFLAGS) $< -o $@ $(LDFLAGS) -lboost_program_options

$(BINDIR)/main2: $(SRCDIR)/main2.cpp
	$(CXX) $(CXXFLAGS) $< -o $@ $(LDFLAGS) -ltbb

clean:
	${RM} -r $(BINDIR)
```

`main1.cpp`:

```cpp
#include <boost/program_options.hpp>
#include <iostream>

int main(int argc, char* argv[]) {
    namespace po = boost::program_options;

    po::options_description desc("Options");
    desc.add_options()
        ("help,h", "Show help message")
        ("value,v", po::value<int>(), "Example value");

    po::variables_map vm;
    po::store(po::parse_command_line(argc, argv, desc), vm);
    po::notify(vm);

    if (vm.count("help")) {
        std::cout << desc << "\n";
        return 0;
    }

    if (vm.count("value")) {
        std::cout << "Value = " << vm["value"].as<int>() << "\n";
    }

    return 0;
}
```

`main2.cpp`:

```cpp
#include <oneapi/tbb/parallel_for.h>
#include <iostream>
#include <vector>

int main() {
    std::vector<int> data(10);

    oneapi::tbb::parallel_for(
        std::size_t(0), data.size(),
        [&](std::size_t i) {
            data[i] = static_cast<int>(i * i);
        }
    );

    for (auto x : data) {
        std::cout << x << ' ';
    }
    std::cout << '\n';
}
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§boost, onetbbã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« + main.cppã®ãƒ“ãƒ«ãƒ‰ãŒã§ãã¾ã™ã€‚

```bash
conan install . --build=missing --output-folder=conan
make
```

ã“ã‚Œã«ã‚ˆã£ã¦`build`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«`main1`ã¨`main2`ã®äºŒã¤ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚
å®Ÿéš›ã«å‹•ã‹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```bash
./build/main1 --value 42
./build/main2
```

æœŸå¾…ã—ãŸé€šã‚Šã«å‹•ä½œã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚

# ã¾ã¨ã‚

Conanã‚’ä½¿ã†ã“ã¨ã§C++ã«ãŠã‘ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒæ ¼æ®µã¨ã‚ˆããªã‚Šã€ãƒ‘ã‚¹è§£æ±ºã®ãŸã‚ã«æ•°æ™‚é–“ã‚’ç„¡é§„ã«ã™ã‚‹ç”Ÿæ´»ã‹ã‚‰ãŠã•ã‚‰ã°ã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚
ä¸€åº¦ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚Œã°å¾Œã¯ç°¡å˜ãªã®ã§ã€æ˜¯éä¸€åº¦è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼çš†ã•ã‚“ã®ãƒãƒƒã‚¯ãƒ©ã‚¤ãƒ•ãŒã‚ˆã‚Šæ¥½ã—ããªã‚‹ã‚ˆã†ãŠç¥ˆã‚Šã„ãŸã—ã¾ã™ã€‚
